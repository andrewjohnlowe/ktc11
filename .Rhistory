ktc11_lithic_data <- the_data$ktc11_lithic_data
# aggregate counts and masses per context
ktc11_summary_ceramics_lithics <- full_join(
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, , sum),
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum),
by  = "Context"
)
# aggregate counts and masses per context
ktc11_summary_ceramics_lithics <- full_join(
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum),
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum),
by  = "Context"
)
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum)
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum)
?full_join
ktc11_summary_ceramics_lithics <- full_join(
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum),
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum),
by  = c("ktc11_ceramic_data$Context" = "ktc11_lithic_data$Context")
)
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum)
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum)
full_join(
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum),
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum),
by  = c("ktc11_ceramic_data$Context" = "ktc11_lithic_data$Context")
)
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum)
li <- aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum)
ce <- aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum)
full_join(li, ce, by  = c("ktc11_ceramic_data$Context" = "ktc11_lithic_data$Context")
)
full_join(li, ce, by  = c("ktc11_lithic_data$Context" = "ktc11_ceramic_data$Context")
)
full_join(li, ce, by  = c("ktc11_lithic_data$Context" = "ktc11_ceramic_data$Context"))
)
ktc11_summary_ceramics_lithics <- full_join(
aggregate(data = ktc11_lithic_data, cbind(ktc11_lithic_data$Mass, ktc11_lithic_data$Counts) ~ ktc11_lithic_data$Context, sum),
aggregate(cbind(ktc11_ceramic_data$Mass, ktc11_ceramic_data$Counts) ~ ktc11_ceramic_data$Context, data = ktc11_ceramic_data, sum),
by  = c("ktc11_lithic_data$Context" = "ktc11_ceramic_data$Context")
)
ktc11_summary_ceramics_lithics
library(ktc11)
library(ktc11)
ktc11_lithic_data %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts))
ktc11_lithic_data %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
ktc11_ceramic_data %>%
group_by(Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
library(ktc11)
ktc11_ceramic_data
class(ktc11_ceramic_data)
inherits(ktc11_ceramic_data,"data.frame")
inherits(ktc11_lithic_data,"data.frame")
?if
else
?ifelse
library(ktc11)
library(ktc11)
library(ktc11)
library(ktc11)
library(ktc11)
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
the_data <- read_in_the_data()
View(the_data$ktc11_ceramic_data)
print(apply, 1, ktc11_ceramic_data, class)
ktc11_ceramic_data <- the_data$ktc11_ceramic_data
print(apply, 1, ktc11_ceramic_data, class)
print(apply(ktc11_ceramic_data, 1, class)
)
print(apply(ktc11_ceramic_data, 2, class))
print(apply(ktc11_lithic_data, 2, class))
ktc11_lithic_data <- the_data$ktc11_lithic_data
print(apply(ktc11_lithic_data, 2, class))
print(lapply(ktc11_ceramic_data, class))
print(lapply(ktc11_lithic_data, class))
library(ktc11)
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
print(str(ktc11_ceramic_data))
str(ktc11_ceramic_data)
library(ktc11)
ktc11_lithic_data$Context
ktc11_ceramic_data$Context
ktc11_lithic_data %>%
group_by(ktc11_lithic_data$Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
class(ktc11_lithic_data$Context)
ktc11_lithic_data[] <- lapply(ktc11_lithic_data, unclass)
ktc11_lithic_data
ktc11_ceramic_data[] <- lapply(ktc11_ceramic_data, unclass)
ktc11_ceramic_data
ktc11_lithic_data %>%
group_by(ktc11_lithic_data$Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
ktc11_lithic_data %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
ktc11_ceramic_data %>%
group_by(ktc11_ceramic_data$Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
dput(ktc11_ceramic_data)
dput(ktc11_lithic_data)
ktc11_ceramic_data %>%
group_by(ktc11_ceramic_data$Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
ktc11_ceramic_data %>%
group_by(Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
?unclass
library(ktc11)
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
print(ktc11_ceramic_data)
print(ktc11_lithic_data)
print(str(ktc11_ceramic_data))
print(str(ktc11_lithic_data))
ktc11_lithic_data[] <- lapply(ktc11_lithic_data, unclass)
ktc11_ceramic_data[] <- lapply(ktc11_ceramic_data, unclass)
print(lapply(ktc11_ceramic_data, class))
library(ktc11)
print(class(ktc11_ceramic_data$Mass))
print(class(ktc11_ceramic_data$Counts))
print(class(ktc11_lithic_data$Mass))
print(class(ktc11_lithic_data$Counts))
ktc11_summary_ceramics_lithics <- list(
print(ktc11_ceramic_data),
print(ktc11_lithic_data),
print(str(ktc11_ceramic_data)),
print(str(ktc11_lithic_data)),
ktc11_lithic_data[] <- lapply(ktc11_lithic_data, unclass),
ktc11_ceramic_data[] <- lapply(ktc11_ceramic_data, unclass),
print(lapply(ktc11_ceramic_data, class)),
print(lapply(ktc11_lithic_data, class)),
print(class(ktc11_ceramic_data$Mass)),
print(class(ktc11_ceramic_data$Counts)),
print(class(ktc11_lithic_data$Mass)),
print(class(ktc11_lithic_data$Counts))
)
ktc11_summary_ceramics_lithics
library(ktc11)
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
library(ktc11)
table_ceramics_lithics
the_data$ktc11_ceramic_data
print(ktc11_ceramic_data)
table_ceramics_lithics <- function(the_data){
ktc11_ceramic_data <- the_data$ktc11_ceramic_data
ktc11_lithic_data <- the_data$ktc11_lithic_data
ktc11_summary_ceramics_lithics <- list(
print(ktc11_ceramic_data),
print(ktc11_lithic_data),
print(str(ktc11_ceramic_data)),
print(str(ktc11_lithic_data)),
ktc11_lithic_data[] <- lapply(ktc11_lithic_data, unclass),
ktc11_ceramic_data[] <- lapply(ktc11_ceramic_data, unclass),
print(lapply(ktc11_ceramic_data, class)),
print(lapply(ktc11_lithic_data, class)),
print(class(ktc11_ceramic_data$Mass)),
print(class(ktc11_ceramic_data$Counts)),
print(class(ktc11_lithic_data$Mass)),
print(class(ktc11_lithic_data$Counts))
)
return(ktc11_summary_ceramics_lithics)
}
table_ceramics_lithics(the_data)
# Chunk 1
library(knitr)
opts_chunk$set(fig.path='../figures/',
echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE)
library(captioner)
tab_n <- captioner(prefix = "Table")
fig_n <- captioner(prefix = "Figure")
library(dplyr)
# Chunk 2: read_in_the_data
library(ktc11)
the_data <- read_in_the_data()
# while the data was collected we stored it here: https://catalyst.uw.edu/gopost/conversation/bmarwick/628803/post/2229534#2229534 and https://docs.google.com/spreadsheets/d/1_a20envyJUBA69NfSyLu0JniVUxnyKzAePUwQFrkS64/edit?pref=2&pli=1#gid=0
# Chunk 3: table_of_calibrated_dates
# get table of calibrated dates
calibrated_dates <-  calibrate_the_dates(the_data$ktc11_radiocarbon_dates)
# show the table
kable(calibrated_dates[,-ncol(calibrated_dates)])
# Chunk 4: plot_of_calibrated_dates
# show the plot
library(ggplot2)
ggplot(calibrated_dates, aes(midpoint, `Depth below surface (m)`, group = `Material dated`)) +
geom_point(aes(shape = `Material dated`), size = 5) +
geom_smooth(method = "lm", se = FALSE) +
xlab("calibrated years BP") +
scale_y_reverse()
# Chunk 5: mean_difference_offset
# compute mean difference in offset (rather slow)
mean_difference_offset <- round(mean_difference_offset(the_data$ktc11_radiocarbon_dates),0)
# Chunk 6: sediments_strat_plot
# join with carbon isotope data
geoarch_summary_data <- join_carbon_to_summary(the_data$ktc11_d13C_data, the_data$ktc11_summary_geoarch_data)
range_carbon_istope_data <- round(range(geoarch_summary_data[,ncol(geoarch_summary_data)]),2)
# compute summary particle size data from raw data
particle_size_data_summary <-  particle_size_data_summary(the_data$ktc11_particle_size_data)
# join with summary geoarch data
sediments_strat_plot <- cbind(geoarch_summary_data, particle_size_data_summary$particle_size_data_summary_subset)
# compute correlations
corrs <- long_corr_matrix(sediments_strat_plot[,c(-1)])
interesting_corrs <- corrs %>% filter(cor > 0.6 & p < 0.05)
# make column names informative
names(sediments_strat_plot) <- c("Sample ID", "Depth (m)", "pH", "Conductivity \n(mS)", "Soil organic \nmatter (% mass)", "Carbonates \n(% mass)", "Magnetic \nsusceptibility", "Frequency \ndependency", "\u03B413C \u2030 VPDB", "Mean particle \nsize (\u00B5m)", "sd particle size \n(\u00B5m)")
# draw stratigraphic plot
library(analogue)
the_plot <- Stratiplot(sediments_strat_plot[,c(-1, -2)],
y = sediments_strat_plot$`Depth (m)`,
rev = TRUE,
varTypes = "absolute",
type = c("h","l"),
ylab = "Depth below surface (m)",
col = "black",
lwd = 0.5,
lwd.h = 0.5,
labelRot = 90)
# manually change the limits of the panels
# this auto updates ticks and labels
the_plot$x.limits[[1]] <- c(5,11)
the_plot$x.limits[[3]] <- c(0,30)
the_plot$x.limits[[4]] <- c(0,30)
the_plot$x.limits[[6]] <- c(50,100)
the_plot$x.limits[[8]] <- c(0,1000)
the_plot$x.limits[[9]] <- c(0,1000)
the_plot$x.scales$rot <- 45
# draw the plot
the_plot
# Chunk 7: summary_xrd_data
# show the table
ktc11_summary_xrd_data <- the_data$ktc11_summary_xrd_data
kable(ktc11_summary_xrd_data)
# Chunk 8: icp_aes_data_summary
icp_aes_data <- icp_aes_data_summary(the_data$ktc11_raw_ICP_data)
# table of elements
kable(round(icp_aes_data,2))
# Chunk 9: corr_elements
# correlation matrix of elements of interest
icp_aes_data_subset_cor <- round(cor(icp_aes_data),2)
kable(icp_aes_data_subset_cor)
# Chunk 10: denro_elements
# cluster analysis of contexts useing elemental data
d <- dist(icp_aes_data, method = "euclidean") # distance matrix
# Then do the cluster analysis and plot dendrogram
plot(as.dendrogram(hclust(d, method="ward.D2")))
# Chunk 11: table_of_lithics_and_ceramics
table_of_ceramics_lithics <- table_ceramics_lithics(the_data)
#kable(table_of_ceramics_lithics)
table_of_ceramics_lithics
library(ktc11)
table_ceramics_lithics(the_data$ktc11_ceramic_data, the_data$ktc11_lithic_data)
library(ktc11)
the_data$ktc11_ceramic_data
the_data$ktc11_lithic_data
table_ceramics_lithics(the_data$ktc11_ceramic_data, the_data$ktc11_lithic_data)
library(ktc11)
the_data <- read_in_the_data()
table_ceramics_lithics(the_data$ktc11_ceramic_data, the_data$ktc11_lithic_data)
library(ktc11)
table_ceramics_lithics(the_data$ktc11_ceramic_data, the_data$ktc11_lithic_data)
table_ceramics_lithics(mtcars, mtcars)
str(mtcars)
source('G:/My Documents/My Papers/Journal of Archaeological Science/Marwick, Conrad, et al. 2015/ktc11/R/functions.R', echo=TRUE)
list(
a = ktc11_ceramic_data,
b = ktc11_lithic_data,
cc = str(ktc11_ceramic_data),
d = str(ktc11_lithic_data)
)
library(ktc11)
table_ceramics_lithics(mtcars, mtcars)
library(ktc11)
table_ceramics_lithics(mtcars, mtcars)
table_ceramics_lithics <- function(aa, bb){
ktc11_summary_ceramics_lithics <- list(
a = aa,
b = bb,
cc = str(aa),
d = str(bb)
)
return(ktc11_summary_ceramics_lithics)
}
table_ceramics_lithics(mtcars, mtcars)
table_ceramics_lithics <- function(aa, bb){
ktc11_summary_ceramics_lithics <- list(
a = aa,
b = bb,
cc = str(aa),
d = str(bb)
)
return(ktc11_summary_ceramics_lithics)
}
table_ceramics_lithics(mtcars, mtcars)
table_ceramics_lithics <- function(aa, bb){
li <- aa %>%
group_by(gear) %>%
dplyr::summarise(lithic_counts = sum(wt),
lithic_mass = sum(mpg))
return(li)
}
table_ceramics_lithics(mtcars, mtcars)
table_ceramics_lithics <- function(aa, bb){
li <- aa %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, the_data$ktc11_lithic_data)
library(ktc11)
mtcars
library(ktc11)
library(ktc11)
table_ceramics_lithics(mtcars, mtcars, groupby = "gear")
library(ktc11)
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics <- function(lithics, ceramics, groupby){
li <- lithics %>%
group_by_(groupby) %>%
dplyr::summarise_(lithic_counts = sum(wt),
lithic_mass = sum(mpg))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics <- function(lithics, ceramics, groupby){
li <- lithics %>%
group_by_(groupby) %>%
dplyr::summarise_(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
the_data$ktc11_ceramic_data
table_ceramics_lithics <- function(lithics, ceramics, groupby, Counts, Mass){
li <- lithics %>%
group_by_(groupby) %>%
dplyr::summarise_(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics <- function(lithics, ceramics, groupby, Counts = "Counts", Mass = "Mass"){
li <- lithics %>%
group_by_(groupby) %>%
dplyr::summarise_(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics <- function(lithics, ceramics, groupby, Counts , Mass){
li <- lithics %>%
group_by_(groupby) %>%
dplyr::summarise_(lithic_counts = ~sum(Counts),
lithic_mass = ~sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics <- function(lithics, ceramics, Context, Counts , Mass){
li <- lithics %>%
group_by_(Context) %>%
dplyr::summarise_(lithic_counts = ~sum(Counts),
lithic_mass = ~sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data, groupby = "Context")
table_ceramics_lithics(the_data$ktc11_ceramic_data)
table_ceramics_lithics <- function(lithics, ceramics, Context="Context", Counts , Mass){
li <- lithics %>%
group_by_(Context) %>%
dplyr::summarise_(lithic_counts = ~sum(Counts),
lithic_mass = ~sum(Mass))
return(li)
}
table_ceramics_lithics <- function(lithics, ceramics, Context="Context"){
li <- lithics %>%
group_by_(Context) %>%
dplyr::summarise_(lithic_counts = ~sum(Counts),
lithic_mass = ~sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data)
table_ceramics_lithics <- function(lithics, ceramics){
li <- lithics %>%
group_by_("Context") %>%
dplyr::summarise_(lithic_counts = ~sum(Counts),
lithic_mass = ~sum(Mass))
return(li)
}
table_ceramics_lithics(the_data$ktc11_ceramic_data)
library(ktc11)
library(ktc11)
the_data$ktc11_ceramic_data
the_data <- read_in_the_data()
table_ceramics_lithics(the_data$ktc11_ceramic_data)
ktc11_ceramic_data <- read_csv("../data/ktc11_ceramic_data.csv")
ktc11_lithic_data <- read_csv("../data/ktc11_lithic_data.csv")
ktc11_ceramic_data
ktc11_ceramic_data <- read.csv("../data/ktc11_ceramic_data.csv")
ktc11_ceramic_data
str(ktc11_ceramic_data)
ktc11_lithic_data <- read.csv("../data/ktc11_lithic_data.csv")
ktc11_lithic_data
str(ktc11_lithic_data)
library(ktc11)
table_ceramics_lithics(the_data$ktc11_lithic_data)
library(ktc11)
library(ktc11)
library(ktc11)
ktc11_ceramic_data <- read_csv("../data/ktc11_ceramic_data.csv")
# read in the lithic data
ktc11_lithic_data <- read_csv("../data/ktc11_lithic_data.csv")
write.csv(ktc11_ceramic_data, "ktc11_ceramic_data.csv")
write.csv(ktc11_lithic_data, "ktc11_lithic_data.csv")
the_data <- read_in_the_data()
dput(the_data$ktc11_ceramic_data)
the_data$ktc11_ceramic_data
the_data$ktc11_ceramic_data
the_data <- read_in_the_data()
the_data$ktc11_ceramic_data
the_data$ktc11_ceramic_data
the_data$ktc11_lithic_data
li <- the_data$ktc11_lithic_data %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
ce <- the_data$ktc11_ceramic_data %>%
group_by(Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
ktc11_summary_ceramics_lithics <-  full_join(li, ce, by  = "Context")
ktc11_summary_ceramics_lithics
the_data$ktc11_lithic_data
ktc11_ceramic_data <- read_csv("../data/ktc11_ceramic_data.csv")
# read in the lithic data
ktc11_lithic_data <- read_csv("../data/ktc11_lithic_data.csv")
library(ktc11)
library(ktc11)
library(ktc11)
table_ceramics_lithics <- function(lithics, ceramics){
# aggregate counts and masses per context
li <- lithics %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
ce <- ceramics %>%
group_by(Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
ktc11_summary_ceramics_lithics <-  full_join(li, ce, by  = "Context")
# meaningful column names
names(ktc11_summary_ceramics_lithics) <- c('Context', "Lithic mass (g)", "Lithic count (n)", "Ceramic mass (g)", "Ceramic count (n)")
# reorder so that it's in the correct order
ktc11_summary_ceramics_lithics <- ktc11_summary_ceramics_lithics[c(1,8,9,2,3,4,5,7,6), ]
return(ktc11_summary_ceramics_lithics)
}
ktc11_summary_ceramics_lithics <- table_ceramics_lithics(the_data$ktc11_lithic_data, the_data$ktc11_ceramic_data)
library(dplyr)
ktc11_summary_ceramics_lithics <- table_ceramics_lithics(the_data$ktc11_lithic_data, the_data$ktc11_ceramic_data)
the_data <- read_in_the_data()
setwd("G:/My Documents/My Papers/Journal of Archaeological Science/Marwick, Conrad, et al. 2015/ktc11/analysis/paper")
the_data <- read_in_the_data()
table_ceramics_lithics(the_data$ktc11_lithic_data, the_data$ktc11_ceramic_data)
lithics <- the_data$ktc11_lithic_data
ceramics <- the_data$ktc11_ceramic_data
# aggregate counts and masses per context
li <- lithics %>%
group_by(Context) %>%
dplyr::summarise(lithic_counts = sum(Counts),
lithic_mass = sum(Mass))
li
ce <- ceramics %>%
group_by(Context) %>%
dplyr::summarise(ceramic_counts = sum(Counts),
ceramic_mass = sum(Mass))
ce
ktc11_summary_ceramics_lithics <-  full_join(li, ce, by  = "Context")
ktc11_summary_ceramics_lithics
ktc11_summary_ceramics_lithics <- ktc11_summary_ceramics_lithics[c(1,8,9,2,3,4,5,7,6), ]
ktc11_summary_ceramics_lithics
library(ktc11)
library(ktc11)
library(ktc11)
Iter =  10#sets the number of simulation iterations#
N =    100#sets the population size#
mu =  0.1#sets the probability of mutation in each iteration#
b <- c(1:N)
V <- matrix(0, N,(Iter-1))
B <- cbind(b, V)     # N x Iter matrix that stores the simulation results, rows correspond to entities while columns correspond to simulation time (generation number)
inov = N+1 #initializes the value of the first innovation#
for (m in 2:Iter) {
for(i in 1:N) {
stoh <- runif(1,0,1)
if (stoh < mu){B[i,m]<- inov; inov = inov + 1} else {h <- sample.int(N,1,replace = TRUE);
B[i,m] <- B[h,(m-1)]}
}
}
V
B
